!function(){function e(e){this.message=e}var t="undefined"!=typeof exports?exports:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=Error(),e.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var i,o,r=0,a=n,s="";t.charAt(0|r)||(a="=",r%1);s+=a.charAt(63&i>>8-r%1*8)){if((o=t.charCodeAt(r+=.75))>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");i=i<<8|o}return s}),t.atob||(t.atob=function(t){if(t=t.replace(/=+$/,""),t.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,o,r=0,a=0,s="";o=t.charAt(a++);~o&&(i=r%4?64*i+o:o,r++%4)?s+=String.fromCharCode(255&i>>(-2*r&6)):0)o=n.indexOf(o);return s})}();var Base64Binary={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeArrayBuffer:function(e){var t=Math.ceil(3*e.length/4),n=new ArrayBuffer(t);return this.decode(e,n),n},decode:function(e,t){var n=this._keyStr.indexOf(e.charAt(e.length-1)),i=this._keyStr.indexOf(e.charAt(e.length-1)),o=Math.ceil(3*e.length/4);64==n&&o--,64==i&&o--;var r,a,s,u,c,d,l,f,p=0,h=0;for(r=new Uint8Array(t||o),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),p=0;o>p;p+=3)c=this._keyStr.indexOf(e.charAt(h++)),d=this._keyStr.indexOf(e.charAt(h++)),l=this._keyStr.indexOf(e.charAt(h++)),f=this._keyStr.indexOf(e.charAt(h++)),a=c<<2|d>>4,s=(15&d)<<4|l>>2,u=(3&l)<<6|f,r[p]=a,64!=l&&(r[p+1]=s),64!=f&&(r[p+2]=u);return r}};if(window.AudioContext=window.AudioContext||window.webkitAudioContext||null,window.OfflineAudioContext=window.OfflineAudioContext||window.webkitOfflineAudioContext||null,function(e){var t,n,i,o=function(e){return"[object Function]"===Object.prototype.toString.call(e)||"[object AudioContextConstructor]"===Object.prototype.toString.call(e)},r=[["createGainNode","createGain"],["createDelayNode","createDelay"],["createJavaScriptNode","createScriptProcessor"]];o(e)&&(n=new e,n.destination&&n.sampleRate&&(t=e.prototype,i=Object.getPrototypeOf(n.createBufferSource()),o(i.start)||o(i.noteOn)&&(i.start=function(e,t,n){switch(arguments.length){case 0:throw Error("Not enough arguments.");case 1:this.noteOn(e);break;case 2:if(!this.buffer)throw Error("Missing AudioBuffer");this.noteGrainOn(e,t,this.buffer.duration-t);break;case 3:this.noteGrainOn(e,t,n)}}),o(i.noteOn)||(i.noteOn=i.start),o(i.noteGrainOn)||(i.noteGrainOn=i.start),o(i.stop)||(i.stop=i.noteOff),o(i.noteOff)||(i.noteOff=i.stop),r.forEach(function(e){for(var t,n;e.length;)t=e.pop(),o(this[t])?this[e.pop()]=this[t]:(n=e.pop(),this[t]=this[n])},t)))}(window.AudioContext),function(){"use strict";function e(){}function t(){this.inputInUse=!1,this.outputInUse=!1;var e=document.createElement("object");e.id="_Jazz"+Math.random()+"ie",e.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",this.activeX=e;var t=document.createElement("object");t.id="_Jazz"+Math.random(),t.type="audio/x-jazz",e.appendChild(t),this.objRef=t;var n=document.createElement("p");n.appendChild(document.createTextNode("This page requires the "));var i=document.createElement("a");i.appendChild(document.createTextNode("Jazz plugin")),i.href="http://jazz-soft.net/",n.appendChild(i),n.appendChild(document.createTextNode(".")),t.appendChild(n);var o=document.getElementById("MIDIPlugin");if(!o){var o=document.createElement("div");o.id="MIDIPlugin",o.style.position="absolute",o.style.visibility="hidden",o.style.left="-9999px",o.style.top="-9999px",document.body.appendChild(o)}o.appendChild(e),this._Jazz=this.objRef.isJazz?this.objRef:this.activeX.isJazz?this.activeX:null,this._Jazz&&(this._Jazz._jazzTimeZero=this._Jazz.Time(),this._Jazz._perfTimeZero=window.performance.now())}function n(){this._promise&&this._promise.fail({code:1})}function i(){this.jazz.MidiOutLong(this.data)}var o,r,a,s,u,c;e.prototype.then=function(e,t){this.accept=e,this.reject=t},e.prototype.succeed=function(e){this.accept&&this.accept(e)},e.prototype.fail=function(e){this.reject&&this.reject(e)},o=function(){return(new r)._promise},r=function(){this._jazzInstances=[],this._jazzInstances.push(new t),this._promise=new e,this._jazzInstances[0]._Jazz?(this._Jazz=this._jazzInstances[0]._Jazz,window.setTimeout(a.bind(this),3)):window.setTimeout(n.bind(this),3)},a=function(){this._promise&&this._promise.succeed(this)},r.prototype.inputs=function(){if(!this._Jazz)return null;for(var e=this._Jazz.MidiInList(),t=Array(e.length),n=0;n<e.length;n++)t[n]=new s(this,e[n],n);return t},r.prototype.outputs=function(){if(!this._Jazz)return null;for(var e=this._Jazz.MidiOutList(),t=Array(e.length),n=0;n<e.length;n++)t[n]=new u(this,e[n],n);return t},s=function(e,n,i){this._listeners=[],this._midiAccess=e,this._index=i,this._inLongSysexMessage=!1,this._sysexBuffer=new Uint8Array,this.id=i+"."+n,this.manufacturer="",this.name=n,this.type="input",this.version="",this.onmidimessage=null;for(var o=null,r=0;r<e._jazzInstances.length&&!o;r++)e._jazzInstances[r].inputInUse||(o=e._jazzInstances[r]);o||(o=new t,e._jazzInstances.push(o)),o.inputInUse=!0,this._jazzInstance=o._Jazz,this._input=this._jazzInstance.MidiInOpen(this._index,c.bind(this))},s.prototype.addEventListener=function(e,t){if("midimessage"===e){for(var n=0;n<this._listeners.length;n++)if(this._listeners[n]==t)return;this._listeners.push(t)}},s.prototype.removeEventListener=function(e,t){if("midimessage"===e)for(var n=0;n<this._listeners.length;n++)if(this._listeners[n]==t)return void this._listeners.splice(n,1)},s.prototype.preventDefault=function(){this._pvtDef=!0},s.prototype.dispatchEvent=function(e){this._pvtDef=!1;for(var t=0;t<this._listeners.length;t++)this._listeners[t].handleEvent?this._listeners[t].handleEvent.bind(this)(e):this._listeners[t].bind(this)(e);return this.onmidimessage&&this.onmidimessage(e),this._pvtDef},s.prototype.appendToSysexBuffer=function(e){var t=this._sysexBuffer.length,n=new Uint8Array(t+e.length);n.set(this._sysexBuffer),n.set(e,t),this._sysexBuffer=n},s.prototype.bufferLongSysex=function(e,t){for(var n=t;n<e.length;){if(247==e[n])return n++,this.appendToSysexBuffer(e.slice(t,n)),n;n++}return this.appendToSysexBuffer(e.slice(t,n)),this._inLongSysexMessage=!0,n},c=function(e,t){var n,i=0,o=!1;for(n=0;n<t.length;n+=i){if(this._inLongSysexMessage){if(n=this.bufferLongSysex(t,n),247!=t[n-1])return;o=!0}else switch(o=!1,240&t[n]){case 128:case 144:case 160:case 176:case 224:i=3;break;case 192:case 208:i=2;break;case 240:switch(t[n]){case 240:if(n=this.bufferLongSysex(t,n),247!=t[n-1])return;o=!0;break;case 241:case 243:i=2;break;case 242:i=3;break;default:i=1}}var r=document.createEvent("Event");r.initEvent("midimessage",!1,!1),r.receivedTime=parseFloat(""+e)+this._jazzInstance._perfTimeZero,o||this._inLongSysexMessage?(r.data=new Uint8Array(this._sysexBuffer),this._sysexBuffer=new Uint8Array(0),this._inLongSysexMessage=!1):r.data=new Uint8Array(t.slice(n,i+n)),this.dispatchEvent(r)}},u=function(e,n,i){this._listeners=[],this._midiAccess=e,this._index=i,this.id=i+"."+n,this.manufacturer="",this.name=n,this.type="output",this.version="";for(var o=null,r=0;r<e._jazzInstances.length&&!o;r++)e._jazzInstances[r].outputInUse||(o=e._jazzInstances[r]);o||(o=new t,e._jazzInstances.push(o)),o.outputInUse=!0,this._jazzInstance=o._Jazz,this._jazzInstance.MidiOutOpen(this.name)},u.prototype.send=function(e,t){var n=0;if(0===e.length)return!1;if(t&&(n=Math.floor(t-window.performance.now())),t&&n>1){var o={};o.jazz=this._jazzInstance,o.data=e,window.setTimeout(i.bind(o),n)}else this._jazzInstance.MidiOutLong(e);return!0},window.navigator.requestMIDIAccess||(window.navigator.requestMIDIAccess=o)}(window),function(e){function t(){for(var t=["moz","webkit","o","ms"],n=t.length,i={value:function(e){return function(){return Date.now()-e}}(Date.now())};n>=0;n--)if(t[n]+"Now"in e.performance)return i.value=function(t){return function(){e.performance[t]()}}(t[n]+"Now"),i;return"timing"in e.performance&&"connectStart"in e.performance.timing&&(i.value=function(){return function(){Date.now()}}(e.performance.timing.connectStart)),i}var n,i={};"performance"in e&&"now"in e.performance||("performance"in e||Object.defineProperty(e,"performance",{get:function(){return i}}),n=t(),Object.defineProperty(e.performance,"now",n))}(window),"undefined"==typeof MIDI&&(MIDI={}),function(e){"use strict";var t={},n=0,i=function(e){n++;var i=document.body,o=new Audio,r=e.split(";")[0];o.id="audio",o.setAttribute("preload","auto"),o.setAttribute("audiobuffer",!0),o.addEventListener("error",function(){i.removeChild(o),t[r]=!1,n--},!1),o.addEventListener("canplaythrough",function(){i.removeChild(o),t[r]=!0,n--},!1),o.src="data:"+e,i.appendChild(o)};e.audioDetect=function(e){if(navigator.requestMIDIAccess)if(Function.prototype.toString.call(navigator.requestMIDIAccess).indexOf("[native code]"))t.webmidi=!0;else for(var o=0;navigator.plugins.length>o;o++){var r=navigator.plugins[o];r.name.indexOf("Jazz-Plugin")<0||(t.webmidi=!0)}if("undefined"==typeof Audio)return e({});t.audiotag=!0,(window.AudioContext||window.webkitAudioContext)&&(t.webaudio=!0);var a=new Audio;if(void 0===a.canPlayType)return e(t);var s=a.canPlayType('audio/ogg; codecs="vorbis"');s="probably"===s||"maybe"===s;var u=a.canPlayType("audio/mpeg");if(u="probably"===u||"maybe"===u,!s&&!u)return void e(t);s&&i("audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA="),u&&i("audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq");var c=(new Date).getTime(),d=window.setInterval(function(){var i=(new Date).getTime(),o=i-c>5e3;(!n||o)&&(window.clearInterval(d),e(t))},1)}}(MIDI),function(e){"use strict";e.GM=function(e){var t=function(e){return e.replace(/[^a-z0-9 ]/gi,"").replace(/[ ]/g,"_").toLowerCase()},n={byName:{},byId:{},byCategory:{}};for(var i in e)for(var o=e[i],r=0,a=o.length;a>r;r++){var s=o[r];if(s){var u=parseInt(s.substr(0,s.indexOf(" ")),10);s=s.replace(u+" ",""),n.byId[--u]=n.byName[t(s)]=n.byCategory[t(i)]={id:t(s),instrument:s,number:u,category:i}}}return n}({Piano:["1 Acoustic Grand Piano","2 Bright Acoustic Piano","3 Electric Grand Piano","4 Honky-tonk Piano","5 Electric Piano 1","6 Electric Piano 2","7 Harpsichord","8 Clavinet"],"Chromatic Percussion":["9 Celesta","10 Glockenspiel","11 Music Box","12 Vibraphone","13 Marimba","14 Xylophone","15 Tubular Bells","16 Dulcimer"],Organ:["17 Drawbar Organ","18 Percussive Organ","19 Rock Organ","20 Church Organ","21 Reed Organ","22 Accordion","23 Harmonica","24 Tango Accordion"],Guitar:["25 Acoustic Guitar (nylon)","26 Acoustic Guitar (steel)","27 Electric Guitar (jazz)","28 Electric Guitar (clean)","29 Electric Guitar (muted)","30 Overdriven Guitar","31 Distortion Guitar","32 Guitar Harmonics"],Bass:["33 Acoustic Bass","34 Electric Bass (finger)","35 Electric Bass (pick)","36 Fretless Bass","37 Slap Bass 1","38 Slap Bass 2","39 Synth Bass 1","40 Synth Bass 2"],Strings:["41 Violin","42 Viola","43 Cello","44 Contrabass","45 Tremolo Strings","46 Pizzicato Strings","47 Orchestral Harp","48 Timpani"],Ensemble:["49 String Ensemble 1","50 String Ensemble 2","51 Synth Strings 1","52 Synth Strings 2","53 Choir Aahs","54 Voice Oohs","55 Synth Choir","56 Orchestra Hit"],Brass:["57 Trumpet","58 Trombone","59 Tuba","60 Muted Trumpet","61 French Horn","62 Brass Section","63 Synth Brass 1","64 Synth Brass 2"],Reed:["65 Soprano Sax","66 Alto Sax","67 Tenor Sax","68 Baritone Sax","69 Oboe","70 English Horn","71 Bassoon","72 Clarinet"],Pipe:["73 Piccolo","74 Flute","75 Recorder","76 Pan Flute","77 Blown Bottle","78 Shakuhachi","79 Whistle","80 Ocarina"],"Synth Lead":["81 Lead 1 (square)","82 Lead 2 (sawtooth)","83 Lead 3 (calliope)","84 Lead 4 (chiff)","85 Lead 5 (charang)","86 Lead 6 (voice)","87 Lead 7 (fifths)","88 Lead 8 (bass + lead)"],"Synth Pad":["89 Pad 1 (new age)","90 Pad 2 (warm)","91 Pad 3 (polysynth)","92 Pad 4 (choir)","93 Pad 5 (bowed)","94 Pad 6 (metallic)","95 Pad 7 (halo)","96 Pad 8 (sweep)"],"Synth Effects":["97 FX 1 (rain)","98 FX 2 (soundtrack)","99 FX 3 (crystal)","100 FX 4 (atmosphere)","101 FX 5 (brightness)","102 FX 6 (goblins)","103 FX 7 (echoes)","104 FX 8 (sci-fi)"],Ethnic:["105 Sitar","106 Banjo","107 Shamisen","108 Koto","109 Kalimba","110 Bagpipe","111 Fiddle","112 Shanai"],Percussive:["113 Tinkle Bell","114 Agogo","115 Steel Drums","116 Woodblock","117 Taiko Drum","118 Melodic Tom","119 Synth Drum"],"Sound effects":["120 Reverse Cymbal","121 Guitar Fret Noise","122 Breath Noise","123 Seashore","124 Bird Tweet","125 Telephone Ring","126 Helicopter","127 Applause","128 Gunshot"]}),e.getInstrument=function(t){var n=e.channels[t];return n&&n.instrument},e.setInstrument=function(t,n,i){var o=e.channels[t];return i?setTimeout(function(){o.instrument=n},i):void(o.instrument=n)},e.getMono=function(t){var n=e.channels[t];return n&&n.mono},e.setMono=function(t,n,i){var o=e.channels[t];return i?setTimeout(function(){o.mono=n},i):void(o.mono=n)},e.getOmni=function(t){var n=e.channels[t];return n&&n.omni},e.setOmni=function(t,n){var i=e.channels[t];return delay?setTimeout(function(){i.omni=n},delay):void(i.omni=n)},e.getSolo=function(t){var n=e.channels[t];return n&&n.solo},e.setSolo=function(t,n){var i=e.channels[t];return delay?setTimeout(function(){i.solo=n},delay):void(i.solo=n)},e.channels=function(){for(var e={},t=0;16>t;t++)e[t]={instrument:t,pitchBend:0,mute:!1,mono:!1,omni:!1,solo:!1};return e}(),e.keyToNote={},e.noteToKey={},function(){for(var t=21,n=108,i=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],o=t;n>=o;o++){var r=(o-12)/12>>0,a=i[o%12]+r;e.keyToNote[a]=o,e.noteToKey[o]=a}}()}(MIDI),"undefined"==typeof MIDI&&(MIDI={}),MIDI.Soundfont=MIDI.Soundfont||{},MIDI.Player=MIDI.Player||{},function(e){"use strict";e.DEBUG=!0,e.USE_XHR=!0,e.soundfontUrl="./soundfont/",e.loadPlugin=function(n){"function"==typeof n&&(n={onsuccess:n}),e.soundfontUrl=n.soundfontUrl||e.soundfontUrl,e.audioDetect(function(i){var o=window.location.hash,r="";if(i[n.api]?r=n.api:i[o.substr(1)]?r=o.substr(1):i.webmidi?r="webmidi":window.AudioContext?r="webaudio":window.Audio&&(r="audiotag"),t[r]){if(n.targetFormat)var a=n.targetFormat;else var a=i["audio/ogg"]?"ogg":"mp3";e.__api=r,e.__audioFormat=a,e.supports=i,e.loadResource(n)}})},e.loadResource=function(n){var i=n.instruments||n.instrument||"acoustic_grand_piano";"object"!=typeof i&&(i=i||0===i?[i]:[]);for(var o=0;o<i.length;o++){var r=i[o];r===+r&&e.GM.byId[r]&&(i[o]=e.GM.byId[r].id)}n.format=e.__audioFormat,n.instruments=i,t[e.__api](n)};var t={webmidi:function(t){e.WebMIDI.connect(t)},audiotag:function(e){n(e,"AudioTag")},webaudio:function(e){n(e,"WebAudio")}},n=function(t,n){for(var o=t.format,r=t.instruments,a=t.onprogress,s=t.onerror,u=r.length,c=u,d=function(){--c||(a&&a("load",1),e[n].connect(t))},l=0;u>l;l++){var f=r[l];MIDI.Soundfont[f]?d():i(r[l],o,function(e,t){var n=t/u,i=(u-c)/u;a&&a("load",n+i,f)},function(){d()},s)}},i=function(t,n,i,o,r){var a=e.soundfontUrl+t+"-"+n+".js";e.USE_XHR?e.util.request({url:a,format:"text",onerror:r,onprogress:i,onsuccess:function(e,t){var n=document.createElement("script");n.language="javascript",n.type="text/javascript",n.text=t,document.body.appendChild(n),o()}}):dom.loadScript.add({url:a,verify:'MIDI.Soundfont["'+t+'"]',onerror:r,onsuccess:function(){o()}})};e.setDefaultPlugin=function(t){for(var n in t)e[n]=t[n]}}(MIDI),function(e){"use strict";window.Audio&&function(){for(var t=e.AudioTag={api:"audiotag"},n={},i=127,o=-1,r=[],a=[],s={},u=0;12>u;u++)r[u]=new Audio;var c=function(t,n){if(e.channels[t]){var u=e.channels[t].instrument,c=e.GM.byId[u].id,n=s[n];if(n){var d=c+""+n.id,l=(o+1)%r.length,f=r[l];if(a[l]=d,!e.Soundfont[c])return void(e.DEBUG&&console.log("404",c));f.src=e.Soundfont[c][n.id],f.volume=i/127,f.play(),o=l}}},d=function(t,n){if(e.channels[t]){var i=e.channels[t].instrument,u=e.GM.byId[i].id,n=s[n];if(n)for(var c=u+""+n.id,d=0,l=r.length;l>d;d++){var f=(d+o+1)%l,p=a[f];if(p&&p==c)return r[f].pause(),void(a[f]=null)}}};t.audioBuffers=r,t.send=function(){},t.setController=function(){},t.setVolume=function(e,t){i=t},t.programChange=function(t,n){e.channels[t].instrument=n},t.pitchBend=function(){},t.noteOn=function(e,t,i,o){var r=n[t];return s[r]?o?setTimeout(function(){c(e,r)},1e3*o):void c(e,r):void 0},t.noteOff=function(){},t.chordOn=function(e,t,i,o){for(var r=0;r<t.length;r++){var a=t[r],u=n[a];if(s[u]){if(o)return setTimeout(function(){c(e,u)},1e3*o);c(e,u)}}},t.chordOff=function(e,t,i){for(var o=0;o<t.length;o++){var r=t[o],a=n[r];if(s[a]){if(i)return setTimeout(function(){d(e,a)},1e3*i);d(e,a)}}},t.stopAllNotes=function(){for(var e=0,t=r.length;t>e;e++)r[e].pause()},t.connect=function(i){e.setDefaultPlugin(t);for(var o in e.keyToNote)n[e.keyToNote[o]]=o,s[o]={id:o};i.onsuccess&&i.onsuccess()}}()}(MIDI),function(e){"use strict";window.AudioContext&&function(){function t(e,t,n){if(o){var r=new Audio;r.src=e,r.controls=!1,r.autoplay=!1,r.preload=!1,r.addEventListener("canplay",function(){t&&t(r)}),r.addEventListener("error",function(e){n&&n(e)}),document.body.appendChild(r)}else if(0===e.indexOf("data:audio")){var a=e.split(",")[1],s=Base64Binary.decodeArrayBuffer(a);i.decodeAudioData(s,t,n)}else{var u=new XMLHttpRequest;u.open("GET",e,!0),u.responseType="arraybuffer",u.onload=function(){i.decodeAudioData(u.response,t,n)},u.send()}}function n(){return new(window.AudioContext||window.webkitAudioContext)}var i,o=!1,r=e.WebAudio={api:"webaudio"},a={},s={},u=127,c={};r.audioBuffers=c,r.send=function(){},r.setController=function(){},r.setVolume=function(e,t,n){n?setTimeout(function(){u=t},1e3*n):u=t},r.programChange=function(t,n){e.channels[t].instrument=n},r.pitchBend=function(t,n){e.channels[t].pitchBend=n},r.noteOn=function(t,n,r,d){d=d||0;var l=e.channels[t],f=l.instrument,p=f+""+n,h=c[p];if(h){if(d<i.currentTime&&(d+=i.currentTime),o)var A=i.createMediaElementSource(h);else{var A=i.createBufferSource();A.buffer=h}if(s){var m=A;for(var g in s)m.connect(s[g].input),m=s[g]}var v=r/127*(u/127)*2-1;if(A.connect(i.destination),A.playbackRate.value=1,A.gainNode=i.createGain(),A.gainNode.connect(i.destination),A.gainNode.gain.value=Math.min(1,Math.max(-1,v)),A.connect(A.gainNode),o){if(d)return setTimeout(function(){h.currentTime=0,h.play()},1e3*d);h.currentTime=0,h.play()}else A.start(d||0);return a[t+""+n]=A,A}},r.noteOff=function(t,n,r){r=r||0;var s=e.channels[t],u=s.instrument,d=u+""+n,l=c[d];if(l){r<i.currentTime&&(r+=i.currentTime);var f=a[t+""+n];if(f){if(f.gainNode){var p=f.gainNode.gain;p.linearRampToValueAtTime(p.value,r),p.linearRampToValueAtTime(-1,r+.3)}return o?r?setTimeout(function(){l.pause()},1e3*r):l.pause():f.noteOff?f.noteOff(r+.5):f.stop(r+.5),delete a[t+""+n],f}}},r.chordOn=function(e,t,n,i){for(var o,a={},s=0,u=t.length;u>s;s++)a[o=t[s]]=r.noteOn(e,o,n,i);return a},r.chordOff=function(e,t,n){for(var i,o={},a=0,s=t.length;s>a;a++)o[i=t[a]]=r.noteOff(e,i,n);return o},r.stopAllNotes=function(){for(var e in a){var t=0;t<i.currentTime&&(t+=i.currentTime);var n=a[e];n.gain.linearRampToValueAtTime(1,t),n.gain.linearRampToValueAtTime(0,t+.3),n.noteOff?n.noteOff(t+.3):n.stop(t+.3),delete a[e]}},r.setEffects=function(e){if(!i.tunajs)return console.log("Effects module not installed.");for(var t=0;t<e.length;t++){var n=e[t],o=new i.tunajs[n.type](n);o.connect(i.destination),s[n.type]=o}},r.connect=function(t){e.setDefaultPlugin(r),r.setContext(i||n(),t.onsuccess)},r.getContext=function(){return i},r.setContext=function(n,o){i=n,"undefined"==typeof Tuna||i.tunajs||(i.tunajs=new Tuna(i));var r=[],a=e.keyToNote;for(var s in a)r.push(s);var u=function(){for(var e in l)if(l[e])return;o&&(o(),o=null)},d=function(n,i,o,r){var a=n[r];a&&(l[i]++,t(a,function(t){t.id=r;var o=e.keyToNote[r];c[i+""+o]=t,0==--l[i]&&(n.isLoaded=!0,u(f))},function(){}))},l={};for(var f in e.Soundfont){var p=e.Soundfont[f];if(!p.isLoaded){var h=e.GM.byName[f],A=h.number;l[A]=0;for(var m=0;m<r.length;m++){var s=r[m];d(p,A,m,s)}}}setTimeout(u,1)}}()}(MIDI),function(e){"use strict";var t=null,n=null,i=e.WebMIDI={api:"webmidi"};i.send=function(e,t){n.send(e,1e3*t)},i.setController=function(e,t,i,o){n.send([e,t,i],1e3*o)},i.setVolume=function(e,t,i){n.send([176+e,7,t],1e3*i)},i.programChange=function(e,t,i){n.send([192+e,t],1e3*i)},i.pitchBend=function(e,t,i){n.send([224+e,t],1e3*i)},i.noteOn=function(e,t,i,o){n.send([144+e,t,i],1e3*o)},i.noteOff=function(e,t,i){n.send([128+e,t,0],1e3*i)},i.chordOn=function(e,t,i,o){for(var r=0;r<t.length;r++){var a=t[r];n.send([144+e,a,i],1e3*o)}},i.chordOff=function(e,t,i){for(var o=0;o<t.length;o++){var r=t[o];n.send([128+e,r,0],1e3*i)}},i.stopAllNotes=function(){n.cancel();for(var e=0;16>e;e++)n.send([176+e,123,0])},i.connect=function(o){e.setDefaultPlugin(i);var r=function(){if(window.AudioContext)o.api="webaudio";else{if(!window.Audio)return;o.api="audiotag"}e.loadPlugin(o)};navigator.requestMIDIAccess().then(function(e){t=e;var i=t.outputs;n="function"==typeof i?i()[0]:i[0],void 0===n?r():o.onsuccess&&o.onsuccess()},r)}}(MIDI),void 0===dom)var dom={};!function(){"use strict";dom.loadScript=function(){return this.loaded={},this.loading={},this},dom.loadScript.prototype.add=function(t){var n=this;"string"==typeof t&&(t={url:t});var i=t.urls;void 0===i&&(i=[{url:t.url,verify:t.verify}]);var o=document.getElementsByTagName("head")[0],r=function(t,i){n.loaded[t.url]||i&&e(i)===!1||(n.loaded[t.url]=!0,n.loading[t.url]&&n.loading[t.url](),delete n.loading[t.url],t.onsuccess&&t.onsuccess(),void 0!==f&&f())},a=!1,s=[],u=function(e){if("string"==typeof e&&(e={url:e,verify:t.verify}),/([\w\d.\[\]\'\"])$/.test(e.verify)){var i=e.test=e.verify;if("object"==typeof i)for(var u=0;u<i.length;u++)s.push(i[u]);else s.push(i)}if(!n.loaded[e.url]){var d=document.createElement("script");d.onreadystatechange=function(){("loaded"===this.readyState||"complete"===this.readyState)&&r(e)},d.onload=function(){r(e)},d.onerror=function(){if(a=!0,delete n.loading[e.url],"object"==typeof e.test)for(var t in e.test)c(e.test[t]);else c(e.test)},d.setAttribute("type","text/javascript"),d.setAttribute("src",e.url),o.appendChild(d),n.loading[e.url]=function(){}}},c=function(e){for(var t=[],n=0;n<s.length;n++)s[n]!==e&&t.push(s[n]);s=t},d=function(n){if(n)r(n,n.test);else for(var o=0;o<i.length;o++)r(i[o],i[o].test);for(var u=!0,o=0;o<s.length;o++)e(s[o])===!1&&(u=!1);!t.strictOrder&&u?a?t.error&&t.error():t.onsuccess&&t.onsuccess():setTimeout(function(){d(n)},10)};if(t.strictOrder){var l=-1,f=function(){if(l++,i[l]){var e=i[l],o=e.url;n.loading[o]?n.loading[o]=function(){e.onsuccess&&e.onsuccess(),f()}:n.loaded[o]?f():(u(e),d(e))}else a?t.error&&t.error():t.onsuccess&&t.onsuccess()};f()}else for(var l=0;l<i.length;l++)u(i[l]),d(i[l])},dom.loadScript=new dom.loadScript;var e=function(e,t){try{e=e.split('"').join("").split("'").join("").split("]").join("").split("[").join(".");for(var n=e.split("."),i=n.length,o=t||window,r=0;i>r;r++){var a=n[r];if(null==o[a])return!1;o=o[a]}return!0}catch(s){return!1}}}(),"undefined"!=typeof module&&module.exports&&(module.exports=dom.loadScript),"undefined"==typeof MIDI&&(MIDI={}),function(e){var t=e.util||(e.util={});if(t.request=function(t,i,o,r){"use strict";"string"==typeof t&&(t={url:t});var a=t.data,s=t.url,u=t.method||(t.data?"POST":"GET"),c=t.format,d=t.headers,l=t.responseType,f=t.withCredentials||!1,i=i||t.onsuccess,o=o||t.onerror,r=r||t.onprogress;if(void 0!==n&&e.loc.isLocalUrl(s))return void n.readFile(s,"utf8",function(e,t){e?o&&o(e):i&&i({responseText:t})});var p=new XMLHttpRequest;if(p.open(u,s,!0),d)for(var h in d)p.setRequestHeader(h,d[h]);else a&&p.setRequestHeader("Content-type","application/x-www-form-urlencoded");return"binary"===c&&p.overrideMimeType&&p.overrideMimeType("text/plain; charset=x-user-defined"),l&&(p.responseType=l),f&&(p.withCredentials="true"),o&&"onerror"in p&&(p.onerror=o),r&&p.upload&&"onprogress"in p.upload&&(a?p.upload.onprogress=function(e){r.call(p,e,event.loaded/event.total)}:p.addEventListener("progress",function(e){var t=0;if(e.lengthComputable)t=e.total;else if(p.totalBytes)t=p.totalBytes;else{var n=parseInt(p.getResponseHeader("Content-Length-Raw"));if(!isFinite(n))return;p.totalBytes=t=n}r.call(p,e,e.loaded/t)})),p.onreadystatechange=function(t){if(4===p.readyState)if(200===p.status||304===p.status||308===p.status||0===p.status&&e.client.cordova){if(i){var n;if("xml"===c)n=t.target.responseXML;else if("text"===c)n=t.target.responseText;else if("json"===c)try{n=JSON.parse(t.target.response)}catch(r){o&&o.call(p,t)}i.call(p,t,n)}}else o&&o.call(p,t)},p.send(a),p},"undefined"!=typeof module&&module.exports){var n=require("fs");XMLHttpRequest=require("xmlhttprequest").XMLHttpRequest,module.exports=e.util.request}}(MIDI);
